--- uboot_patch031/net/nfs.c	2020-09-07 11:15:49.667779033 +0800
+++ uboot/net/nfs.c	2020-09-07 15:02:06.425197745 +0800
@@ -633,6 +633,9 @@
 
 	/* new path length */
 	rlen = ntohl(rpc_pkt.u.reply.data[1 + nfsv3_data_offset]);
+	if (((uchar *)&(rpc_pkt.u.reply.data[0]) - (uchar *)(&rpc_pkt) + rlen) > len)
+		return -NFS_RPC_DROP;
+
 
 	if (*((char *)&(rpc_pkt.u.reply.data[2 + nfsv3_data_offset])) != '/') {
 		int pathlen;
